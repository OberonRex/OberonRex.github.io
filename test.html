<!DOCTYPE html>
<html>
<head>
<script>

var query = window.location.search.substring(1);
var vars = query.split("&");

var aa = {};

for (var i=0;i<vars.length;i++) {
    var pair = vars[i].split("=");
    aa[pair[0]] = pair[1];
  }
  
function ImportValues(){
    SetSelect(aa.KEY_HRTICKSTYLE, "hrTickStyle");
    SetSelect(aa.KEY_HRTICKCOUNT, "hrTickCount")
} 

function SetSelect(tsValue, selectID){
  var selectobject = document.getElementById(selectID);
  for (var i=0; i<selectobject.length; i++){
    if (selectobject.options[i].value == tsValue)
    {
      selectobject.selectedIndex = i;
      break;
    }
  }
}

function allDone(){
  var tSelect = document.getElementById("hrTickStyle");
  var tsv = tSelect.options[tSelect.selectedIndex].value;
  
  tSelect = document.getElementById("hrTickCount");
  var tsv2 = tSelect.options[tSelect.selectedIndex].value;
  
  var aa = {
    "KEY_HRTICKSTYLE": tsv,
    "KEY_HRTICKCOUNT": tsv2
  }
  // Close config page and return data
  location.href = 'pebblejs://close#' + JSON.stringify(aa);
}

function WeatherChanged(){
  if (document.getElementById("WeatherSource").selectedIndex == 0)
    document.getElementById("WUKeyDiv").style.display="none";
  else document.getElementById("WUKeyDiv").style.display="table-row";
}

var w;
function CallPicker(){
    w = window.open('colorpicker.html');
}

function CallBack(){
    //alert('callback');
}

</script>
</head>

<body onload="ImportValues()">

<h1>My Configuration Page, v1.15</h1>

<table>
  <tr>
    <td>Hour Tick Style:</td>
    <td>
      <select id="hrTickStyle">
        <option value="3">Circled Dots</option>
        <option value="0">Lines</option>
      </select>
    </td>
  </tr>
  
  <tr>
    <td>Hour Tick Size: </td>
    <td><input type="text" id="hrTickSize"></td>
  </tr>
  
  <tr>
    <td>Hour Tick Style:</td>
    <td>
      <select id="hrTickCount">
        <option value="0">0</option>
        <option value="4">4</option>
        <option value="12">12</option>
      </select>
    </td>
  </tr>
  
  <tr><td>&nbsp;</td><td>&nbsp;</td></tr>
        
  <tr>
    <td>Weather Source:</td>
    <td>
      <select id="WeatherSource" onchange="WeatherChanged()">
        <option value="0">OpenWeather</option>
        <option value="1">Weather Underground</option>
      </select>
    </td>
  </tr>
  
<tr id=WUKeyDiv style="display:none">
  <td>WU Key:</td>
  <td><input type="text" id="WUKey"></td>
</tr>

</table>

<br><br>
<button type="button" onclick="allDone()">Done</button>

<br><br>
<button type="button" onclick="CallPicker();">Color Picker</button>

</body>
</html>
